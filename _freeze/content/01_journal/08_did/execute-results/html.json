{
  "hash": "c47ce4be06f86a5ce9b2776bd695c80e",
  "result": {
    "markdown": "---\ntitle: \"Difference-in-Differences\"\n---\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-1_9a5866e69ccff4a40d82e96368064c63'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyverse' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'ggplot2' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'purrr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'dplyr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'forcats' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'lubridate' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.3     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dagitty)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'dagitty' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'ggdag' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attache Paket: 'ggdag'\n#> \n#> Das folgende Objekt ist maskiert 'package:stats':\n#> \n#>     filter\n```\n:::\n\n```{.r .cell-code}\nlibrary(MatchIt)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'MatchIt' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nhospdd <- readRDS(\"../../assignment_data/hospdd.rds\")\n```\n:::\n\n# . Manually computing the mean satisfaction for treated and control hospitals before and after the treatment:\n\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-2_86277afed83ed6c842e83e90fe77d23d'}\n\n```{.r .cell-code}\n# Manually compute differences\n# Step 1: Difference between treatment and control group BEFORE treatment\n# control group -> hospital ID 19 and above\n# treatment group -> hospital ID 18 or less\n# treatment begin : from month 4\nbefore_control_A <- hospdd %>%\n  filter(hospital > 18, month < 4) %>% \n  pull(satis)\nbefore_treatment_A <- hospdd %>%\n  filter(hospital <= 18, month < 4) %>% \n  pull(satis)\n\ndiff_before_A <- mean(before_treatment_A) - mean(before_control_A)\n\n# Step 2: Difference between treatment and control group AFTER treatment\nafter_control_A <- hospdd %>%\n  filter(hospital > 18, month >= 4) %>% \n  pull(satis)\nafter_treatment_A <- hospdd %>%\n  filter(hospital <= 18, month >= 4) %>% \n  pull(satis)\n\ndiff_after_A <- mean(after_treatment_A) - mean(after_control_A)\n\n# Step 3: Difference-in-differences. \ndiff_diff_A <- diff_after_A - diff_before_A\ncat(\"Estimate: \", diff_diff_A)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Estimate:  0.8479879\n```\n:::\n:::\n\n\n\n\n# . Using a linear regression to compute the estimate\nIn this context, it is important to note that the variables \"month\" and \"hospital\" are categorical, and they are not continuous or ordinal variables. Therefore, it is advisable to apply the `as.factor()` function to ensure more accurate computations.\n\n::: {.cell hash='08_did_cache/html/unnamed-chunk-3_cfe3c97f2f6fdaf55c83e8bde996d2d0'}\n\n```{.r .cell-code}\nsummary(lm(satis ~ procedure + as.factor(month) + as.factor(hospital), data = hospdd))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satis ~ procedure + as.factor(month) + as.factor(hospital), \n#>     data = hospdd)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -3.1880 -0.4644  0.0067  0.4539  4.2921 \n#> \n#> Coefficients:\n#>                         Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)            3.1716566  0.0562207  56.414  < 2e-16 ***\n#> procedure              0.8479879  0.0342191  24.781  < 2e-16 ***\n#> as.factor(month)2     -0.0096077  0.0292119  -0.329 0.742244    \n#> as.factor(month)3      0.0219686  0.0292119   0.752 0.452050    \n#> as.factor(month)4     -0.0032839  0.0324936  -0.101 0.919504    \n#> as.factor(month)5     -0.0094027  0.0324936  -0.289 0.772305    \n#> as.factor(month)6     -0.0038375  0.0324936  -0.118 0.905990    \n#> as.factor(month)7     -0.0111941  0.0324936  -0.345 0.730478    \n#> as.factor(hospital)2   0.4085664  0.0772418   5.289 1.26e-07 ***\n#> as.factor(hospital)3   0.5336248  0.0793384   6.726 1.88e-11 ***\n#> as.factor(hospital)4   0.2275102  0.0739411   3.077 0.002099 ** \n#> as.factor(hospital)5  -0.1453529  0.0739411  -1.966 0.049360 *  \n#> as.factor(hospital)6   0.4478634  0.0739411   6.057 1.46e-09 ***\n#> as.factor(hospital)7   1.4044164  0.0714559  19.654  < 2e-16 ***\n#> as.factor(hospital)8   0.0718758  0.0763186   0.942 0.346333    \n#> as.factor(hospital)9  -1.5185150  0.0782447 -19.407  < 2e-16 ***\n#> as.factor(hospital)10  1.6828446  0.0772418  21.787  < 2e-16 ***\n#> as.factor(hospital)11  0.2209653  0.0763186   2.895 0.003799 ** \n#> as.factor(hospital)12 -0.0953034  0.0782447  -1.218 0.223256    \n#> as.factor(hospital)13  0.4955931  0.0754658   6.567 5.48e-11 ***\n#> as.factor(hospital)14  0.2330426  0.0793384   2.937 0.003321 ** \n#> as.factor(hospital)15 -0.1444935  0.0793384  -1.821 0.068613 .  \n#> as.factor(hospital)16  1.4142680  0.0772418  18.310  < 2e-16 ***\n#> as.factor(hospital)17  0.4235429  0.0805362   5.259 1.49e-07 ***\n#> as.factor(hospital)18  0.1532761  0.0938164   1.634 0.102346    \n#> as.factor(hospital)19 -0.7453017  0.0811623  -9.183  < 2e-16 ***\n#> as.factor(hospital)20  0.0473874  0.0791140   0.599 0.549207    \n#> as.factor(hospital)21  1.1943370  0.0836232  14.282  < 2e-16 ***\n#> as.factor(hospital)22  0.7993153  0.0823336   9.708  < 2e-16 ***\n#> as.factor(hospital)23  0.7017202  0.0811623   8.646  < 2e-16 ***\n#> as.factor(hospital)24 -0.3081260  0.0866402  -3.556 0.000378 ***\n#> as.factor(hospital)25  0.6464736  0.0927258   6.972 3.40e-12 ***\n#> as.factor(hospital)26  0.2142471  0.0791140   2.708 0.006783 ** \n#> as.factor(hospital)27 -0.3986544  0.0766106  -5.204 2.01e-07 ***\n#> as.factor(hospital)28  0.7119953  0.0836232   8.514  < 2e-16 ***\n#> as.factor(hospital)29  0.2485512  0.0800935   3.103 0.001921 ** \n#> as.factor(hospital)30 -0.1679220  0.0953638  -1.761 0.078304 .  \n#> as.factor(hospital)31  0.5120848  0.0791140   6.473 1.02e-10 ***\n#> as.factor(hospital)32 -0.3233456  0.0800935  -4.037 5.47e-05 ***\n#> as.factor(hospital)33 -0.4539752  0.0791140  -5.738 9.95e-09 ***\n#> as.factor(hospital)34 -0.0004123  0.0746054  -0.006 0.995590    \n#> as.factor(hospital)35  0.3541110  0.0766106   4.622 3.86e-06 ***\n#> as.factor(hospital)36  2.1381425  0.0773811  27.631  < 2e-16 ***\n#> as.factor(hospital)37  0.1404036  0.0927258   1.514 0.130023    \n#> as.factor(hospital)38 -0.0868060  0.0782129  -1.110 0.267093    \n#> as.factor(hospital)39 -0.0234969  0.0823336  -0.285 0.775356    \n#> as.factor(hospital)40  1.1215331  0.0782129  14.339  < 2e-16 ***\n#> as.factor(hospital)41 -0.1497346  0.0766106  -1.954 0.050681 .  \n#> as.factor(hospital)42  0.8811369  0.0850508  10.360  < 2e-16 ***\n#> as.factor(hospital)43 -0.7724325  0.0811623  -9.517  < 2e-16 ***\n#> as.factor(hospital)44  0.0344120  0.0904337   0.381 0.703569    \n#> as.factor(hospital)45 -0.2137495  0.0766106  -2.790 0.005283 ** \n#> as.factor(hospital)46  0.0784915  0.0823336   0.953 0.340452    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 0.7238 on 7315 degrees of freedom\n#> Multiple R-squared:  0.5333,\tAdjusted R-squared:  0.5299 \n#> F-statistic: 160.7 on 52 and 7315 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}