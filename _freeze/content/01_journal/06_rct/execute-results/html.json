{
  "hash": "ffd0d389778e8bee707797cc041f4c5b",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\n---\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_90509e007f3e2d60a85f57d3e23721f7'}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'dplyr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attache Paket: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Die folgenden Objekte sind maskiert von 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Die folgenden Objekte sind maskiert von 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyverse' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'ggplot2' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'purrr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'forcats' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'lubridate' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ forcats   1.0.0     ✔ readr     2.1.4\n#> ✔ ggplot2   3.4.4     ✔ stringr   1.5.0\n#> ✔ lubridate 1.9.3     ✔ tibble    3.2.1\n#> ✔ purrr     1.0.2     ✔ tidyr     1.3.0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nabtest_online <- readRDS(\"../../assignment_data/abtest_online.rds\")\n```\n:::\n\n\n# 1.\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_192d0f3605b784193bc13017ab92abd4'}\n\n```{.r .cell-code}\nlibrary(dplyr)\n# Group by treatment group and compute average outcome\nabtest_online %>%\n  group_by(chatbot) %>%\n  summarise(mean_prev_visit = mean(previous_visit))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"chatbot\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"mean_prev_visit\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"2.169355\"},{\"1\":\"TRUE\",\"2\":\"1.875000\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_7d1ee2af0010fcabc8a706c24aad649a'}\n\n```{.r .cell-code}\n# \nabtest_online %>%\n  group_by(chatbot) %>%\n  summarise(mean_mobile_device = mean(mobile_device))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"chatbot\"],\"name\":[1],\"type\":[\"lgl\"],\"align\":[\"right\"]},{\"label\":[\"mean_mobile_device\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"FALSE\",\"2\":\"0.3185484\"},{\"1\":\"TRUE\",\"2\":\"0.3154762\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\nHere, mean previous visit and mean mobile device user is calculated for the control and treatment group separately which are differentiated according to the chatbot. The mean values are not that different which means the covariates are balanced across the groups. It can also be seen in the plot below:\n\n\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-4_d2baca8e55c3b3876fea5ea59aec1f02'}\n\n```{.r .cell-code}\ndf <- as_tibble(abtest_online)\n\n# Plotting boxplots for mobile_device and previous_visit across chatbot groups\ncovariate_balance_plot <- ggplot(df, aes(x = chatbot, y = previous_visit, fill = mobile_device)) +\n  geom_boxplot() +\n  labs(title = \"Covariate Balance Check\",\n       x = \"Chatbot\",\n       y = \"Previous Visit\") +\n  theme_minimal()\n\n# Print the plot\nprint(covariate_balance_plot)\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-5_3398e398f7558d5044413c1ece795800'}\n\n```{.r .cell-code}\ndf <- as_tibble(abtest_online)\ncompare_visits <- \n  ggplot(df, \n         aes(x = chatbot, \n             y = previous_visit, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"previous_visit\", title = \"Difference in previous_visit\")\n\n\n\ncompare_devices <- \n  ggplot(df, \n         aes(x = chatbot, \n             y = mobile_device, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"mobile_device\", title = \"Difference in mobile_device\")\n\n\ncompare_purchase <- \n  ggplot(df, \n         aes(x = chatbot, \n             y = purchase_amount, \n             color = as.factor(chatbot))) +\n  stat_summary(geom = \"errorbar\", \n               width = .5,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = \"chatbot\", y = \"purchase_amount\", title = \"Difference in purchase_amount\")\n\ncompare_visits\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_devices\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_purchase\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n:::\n\n# 2.\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-6_3cec649fe5d1781db37b7bb7d1d75e88'}\n\n```{.r .cell-code}\nlm_chatbot <- lm(purchase_amount ~ chatbot, data = abtest_online)\nsummary(lm_chatbot, digits = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot, data = abtest_online)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -16.702 -14.478  -9.626  13.922  64.648 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7017     0.8374  19.944  < 2e-16 ***\n#> chatbotTRUE  -7.0756     1.1796  -5.998 2.79e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.65 on 998 degrees of freedom\n#> Multiple R-squared:  0.0348,\tAdjusted R-squared:  0.03383 \n#> F-statistic: 35.98 on 1 and 998 DF,  p-value: 2.787e-09\n```\n:::\n:::\n\nUpon reviewing the linear regression results, it is evident that the 'chatbot' variable has a significantly low p-value, indicating its influence on 'purchase_amount.' The estimate for the treatment group (chatbot = TRUE) is negative, signifying a statistically significant negative impact on 'purchase_amount.' In practical terms, users exposed to the chatbot exhibit a lower purchase amount compared to those not exposed.\n\n# 3.\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-7_0b8ed3e99c6b9c12e93bd246c6b204a6'}\n\n```{.r .cell-code}\nlm_chatbot_mobile <- lm(purchase_amount ~ chatbot * mobile_device, data = abtest_online)\n\nsummary(lm_chatbot_mobile)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot * mobile_device, data = abtest_online)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -16.98 -14.54  -9.95  14.13  65.24 \n#> \n#> Coefficients:\n#>                               Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                    16.9797     1.0152  16.725   <2e-16 ***\n#> chatbotTRUE                    -7.0301     1.4284  -4.922    1e-06 ***\n#> mobile_deviceTRUE              -0.8727     1.7987  -0.485    0.628    \n#> chatbotTRUE:mobile_deviceTRUE  -0.1526     2.5369  -0.060    0.952    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.66 on 996 degrees of freedom\n#> Multiple R-squared:  0.03534,\tAdjusted R-squared:  0.03244 \n#> F-statistic: 12.16 on 3 and 996 DF,  p-value: 8.034e-08\n```\n:::\n:::\n\nThe p-value for chatbotTRUE:mobile_deviceTRUE is comparatively high. So it has less effect on the purchase amount. \\\nUsing the coefficients, CATE for mobile users is -0.1526 \n\n\n# 4.\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-8_bb1a110eb0ad413b28878d43ce09e91f'}\n\n```{.r .cell-code}\nlogistic_regg<- glm(purchase ~ chatbot, family = binomial(link = 'logit'), data = abtest_online)\nsummary(logistic_regg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot, family = binomial(link = \"logit\"), \n#>     data = abtest_online)\n#> \n#> Coefficients:\n#>             Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept) -0.01613    0.08981  -0.180    0.857    \n#> chatbotTRUE -0.98939    0.13484  -7.337 2.18e-13 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1273.3  on 998  degrees of freedom\n#> AIC: 1277.3\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n\n```{.r .cell-code}\n# Extract the coefficient for chatbotTRUE\nodds_ratio <- exp(coef(logistic_regg)[\"chatbotTRUE\"])\nodds_ratio\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> chatbotTRUE \n#>   0.3718025\n```\n:::\n:::\n\nThe negative coefficient for the presence of the chatbot implies, on average, a decrease in the odds of making a purchase. Specifically, the odds ratio of approximately 0.37 indicates that when the chatbot is present, the odds of making a purchase are reduced by about 63% compared to when the chatbot is absent. In other words, the chatbot is associated with a substantial decrease in the likelihood of making a purchase\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}