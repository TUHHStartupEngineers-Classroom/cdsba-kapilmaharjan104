{
  "hash": "7215f780bec9ba991c3343de5fcd17dc",
  "result": {
    "markdown": "---\ntitle: \"DAG\"\n---\n\n\n# 1.\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-1_ed4f7057dfb2ed3854c6adc02b117c98'}\n\n```{.r .cell-code}\n# Load packages\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyverse' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'ggplot2' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'tidyr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'purrr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'dplyr' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'forcats' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'lubridate' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n#> ✔ dplyr     1.1.3     ✔ readr     2.1.4\n#> ✔ forcats   1.0.0     ✔ stringr   1.5.0\n#> ✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n#> ✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n#> ✔ purrr     1.0.2     \n#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n#> ✖ dplyr::filter() masks stats::filter()\n#> ✖ dplyr::lag()    masks stats::lag()\n#> ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(dagitty)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'dagitty' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggdag)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: Paket 'ggdag' wurde unter R Version 4.3.2 erstellt\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attache Paket: 'ggdag'\n#> \n#> Das folgende Objekt ist maskiert 'package:stats':\n#> \n#>     filter\n```\n:::\n\n```{.r .cell-code}\nparkingDAG <- dagify(\n  X ~ Z,\n  Y ~ Z,\n  Y ~ X,\n  coords = list(x = c(Y = 3, Z = 2, X = 1),\n                y = c(Y = 0, Z = 1, X = 0)),\n  labels = list(X = \"Parking Spot\",\n                Y = \"Sales\", \n                Z = \"Location\")\n)\n\n# Plot DAG\nggdag(parkingDAG) +\n  theme_dag_gray() + # custom theme, can be left out\n  geom_dag_point(color = \"lightgreen\") +\n  geom_dag_text(color = \"red\") +\n  geom_dag_edges(edge_color = \"blue\") +\n  geom_dag_label_repel(aes(label = label))\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n# 2.\nIn the data, you find three variables: satisfaction, follow_ups and subscription. Perform the following steps:\\\n\n**regress satisfaction on follow_ups**\\\n\n\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-2_45db4face061f8ce4d9a9cf0b6c10c5b'}\n\n```{.r .cell-code}\ncustomer_sat <- readRDS(\"../../assignment_data/customer_sat.rds\")\nlm_followUps <- lm(satisfaction ~ follow_ups, data = customer_sat)\nsummary(lm_followUps, digits = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ follow_ups, data = customer_sat)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -12.412  -5.257   1.733   4.506  12.588 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  78.8860     4.2717  18.467 1.04e-10 ***\n#> follow_ups   -3.3093     0.6618  -5.001 0.000243 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 7.923 on 13 degrees of freedom\n#> Multiple R-squared:  0.658,\tAdjusted R-squared:  0.6316 \n#> F-statistic: 25.01 on 1 and 13 DF,  p-value: 0.0002427\n```\n:::\n:::\n\n\n\n**regress satisfaction on follow_ups and account for subscription**\n\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-3_0b37dc4aebf74b2037bc8c8da344b14b'}\n\n```{.r .cell-code}\nlm_all <- lm(satisfaction ~., data = customer_sat)\nsummary(lm_all, digits = 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = satisfaction ~ ., data = customer_sat)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -4.3222 -2.1972  0.3167  2.2667  3.9944 \n#> \n#> Coefficients:\n#>                      Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)           26.7667     6.6804   4.007  0.00206 ** \n#> follow_ups             2.1944     0.7795   2.815  0.01682 *  \n#> subscriptionPremium   44.7222     5.6213   7.956 6.88e-06 ***\n#> subscriptionPremium+  18.0722     2.1659   8.344 4.37e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 2.958 on 11 degrees of freedom\n#> Multiple R-squared:  0.9597,\tAdjusted R-squared:  0.9487 \n#> F-statistic: 87.21 on 3 and 11 DF,  p-value: 5.956e-08\n```\n:::\n:::\n\n# 3.\nIn the first table, the analysis shows that follow-ups have a very low p-value, indicating a significant impact on satisfaction. The negative estimate suggests that, on average, more follow-ups are associated with lower satisfaction scores.\\\n\nHowever, upon considering the new regression data, it becomes evident that the subscription plan seems to exert a comparatively stronger impact on satisfaction than follow-ups. Specifically, having a premium or premium plus subscription is associated with higher satisfaction, as indicated by their positive estimates. The sign of the follow-ups estimate has also changed, now suggesting that more follow-ups are associated with higher satisfaction.\\\n\nThis shift in estimates implies that the new subscription variable acts as a confounding variable. To accurately understand the relationship between follow-ups and satisfaction, it becomes essential to condition on the subscription variable. In other words, to draw meaningful conclusions, it is crucial to compare data for the same type of subscription, ensuring that the impact of follow-ups on satisfaction is assessed within each subscription category.\\\n\n# 4.\n\n::: {.cell hash='05_dag_cache/html/unnamed-chunk-4_0955c0615fff9eaa6eb35b1fe825ed0f'}\n\n```{.r .cell-code}\ndf <- as_tibble(customer_sat)\n\n# Not conditioning on subscription\nnot_cond <- ggplot(df, aes(x = follow_ups, y = satisfaction)) +\n  geom_point() +\n  stat_smooth(method = \"lm\", se = F)\n\n\n# Conditioning on subscription  \ncond <- ggplot(df, aes(x = follow_ups, y = satisfaction, color = subscription)) +\n  geom_point(alpha = .8) +\n  stat_smooth(method = \"lm\", se = F) +\n  theme(legend.position = \"right\")\n\nnot_cond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncond\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# DAG\n\nsatisf_DAG <- dagify(\n  X ~ Z,\n  Y ~ Z,\n  Y ~ X,\n  coords = list(x = c(Y = 3, Z = 2, X = 1),\n                y = c(Y = 0, Z = 1, X = 0)),\n  labels = list(X = \"Follow ups\",\n                Y = \"Satisfaction\", \n                Z = \"Subscription\")\n)\n# Plot DAG\nggdag(satisf_DAG) +\n  theme_dag_gray() + # custom theme, can be left out\n  geom_dag_point(color = \"lightgreen\") +\n  geom_dag_text(color = \"red\") +\n  geom_dag_edges(edge_color = \"blue\") +\n  geom_dag_label_repel(aes(label = label))\n```\n\n::: {.cell-output-display}\n![](05_dag_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}